<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>详情页</title>
    <link rel="stylesheet" href="css/page.css">
</head>

<body>
    <div class="head">
        <div class="head_center">
            <div class="address">
                <span>送至：北京</span>
                <ul>
                    <li>上海</li>
                    <li>广州</li>
                    <li>深圳</li>
                    <li>西安</li>
                    <li>南京</li>
                    <li>苏州</li>
                    <li>江苏</li>
                    <li>浙江</li>
                    <li>青岛</li>
                    <li>太原</li>
                    <li>上海</li>
                    <li>广州</li>
                    <li>深圳</li>
                    <li>西安</li>
                    <li>南京</li>
                    <li>苏州</li>
                    <li>江苏</li>
                    <li>浙江</li>
                    <li>青岛</li>
                    <li>太原</li>
                </ul>
            </div>
            <div class="user-enter">
                您好，欢迎来到
                <a href="#" class="home">为为商城</a>
                <a href="login.html" class="log">请登录</a>
                &nbsp;&nbsp;
                <a href="register.html" class="reg">免费注册</a>
            </div>
            <div class="menu">
                <ul>
                    <li><a href="#">我的订单</a><i></i></li>
                    <li><a href="#">商家中心</a><i></i></li>
                    <li><img src="images/mobile-shopicon.png" alt=""> <a href="#">手机为为</a><i></i></li>
                    <li><a href="#">客户服务</a><i></i></li>
                    <li><img src="images/weixin.png" alt=""> <a href="#">关注我们</a><i></i></li>
                </ul>
            </div>
        </div>
    </div>

    <header>
        <div class="head_center">
            <div class="head-left1">
                <a href="#">
                    <img src="images/log_pic.png" alt="">
                </a>
            </div>
            <div class="head-left2"></div>
            <div class="search">
                <form action="">
                    <div class="search_tips">商品<i></i></div>
                    <input type="text" placeholder="请输入你要搜索的商品关键字" />
                    <input type="submit" value="搜索" />
                </form>
                <div class="keyword">
                    <ul>
                        <li><a href="#">沙发</a></li>
                        <li><a href="#">床</a></li>
                        <li><a href="#">瓷砖</a></li>
                        <li><a href="#">地板</a></li>
                        <li><a href="#">餐桌</a></li>
                    </ul>
                </div>
            </div>
            <div class="mycar">
                <span></span>
                我的购物车
                <i></i>
            </div>
        </div>
    </header>

    <div class="nav">
        <div class="nav_center">
            <div class="all-category">
                <div class="title">
                    <i></i>
                    <p><a href="#">精选分类推荐</a></p>
                </div>
                <div class="category">
                    <div class="menu">
                        <div class="menu-list">
                            <a href="#" class="category-bt">建材</a>
                            <ul class="son-class">
                                <li><a href="#">基础建材</a></li>
                                <li><a href="#">瓷砖/大理石/陶瓷</a></li>
                                <li><a href="#">卫浴</a></li>
                                <li><a href="#">集成吊顶</a></li>
                                <li><a href="#">橱柜</a></li>
                                <li><a href="#">淋浴房</a></li>
                                <li><a href="#">地板/榻榻米</a></li>
                                <li><a href="#">移门衣柜</a></li>
                                <li><a href="#">墙纸</a></li>
                                <li><a href="#">门窗</a></li>
                                <li><a href="#">净水器/水处理</a></li>
                                <li><a href="#">定制楼梯</a></li>
                                <li><a href="#">保险箱</a></li>
                            </ul>
                        </div>
                        <div class="menu-list">
                            <a href="#" class="category-bt">家具家纺</a>
                            <ul class="son-class">
                                <li><a href="#">卧室</a></li>
                                <li><a href="#">客厅</a></li>
                                <li><a href="#">餐厅</a></li>
                                <li><a href="#">书房</a></li>
                                <li><a href="#">儿童房</a></li>
                                <li><a href="#">办公家具</a></li>
                                <li><a href="#">家饰</a></li>
                                <li><a href="#">软装</a></li>
                                <li><a href="#">家纺</a></li>
                            </ul>
                        </div>
                        <div class="menu-list last-list">
                            <a class="category-bt">装修服务</a>
                            <ul class="son-class">
                                <li><a href="#">免费设计</a></li>
                                <li><a href="#">装修设计</a></li>
                                <li><a href="#">装修大全</a></li>
                                <li><a href="#">装修效果图</a></li>
                                <li><a href="#">家居图册</a></li>
                                <li><a href="#">精品专题</a></li>
                                <li><a href="#">装修攻略</a></li>
                                <li><a href="#">装修前</a></li>
                                <li><a href="#">装修中</a></li>
                                <li><a href="#">装修后</a></li>
                                <li><a href="#">装修风水</a></li>
                                <li><a href="#">家装学堂</a></li>
                                <li><a href="#">家居生活</a></li>
                                <li><a href="#">植物花卉</a></li>
                                <li><a href="#">宠物</a></li>
                                <li><a href="#">手工DIY</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <ul class="list">
                <li><a href="#">首页</a></li>
                <li><a href="#">建材</a></li>
                <li><a href="#">家居家纺</a></li>
                <li><a href="#">品牌</a></li>
                <li><a href="#">店铺</a></li>
                <li><a href="#">装修攻略</a></li>
                <li><a href="#">装修图库</a></li>
            </ul>
        </div>
    </div>

    <div class="goods-info">
        <div class="goods-title">
            <p>
                <a href="javascript:;">首页</a>&nbsp;&nbsp;>&nbsp;&nbsp;
                <a href="javascript:;">热卖商品</a>&nbsp;&nbsp;>&nbsp;&nbsp;
                <span>商品详情</span>
            </p>
        </div>
    </div>


    <div class="goods-fdj">
        <!--<div class="goods-left">
            <img src="images/hot-goods01.jpg" alt=""/>
        </div>
        <div class="goods-right">
            <h2>商品名称</h2>
            <div class="goods-price">
                <p>活&nbsp;动&nbsp;价&nbsp;格&nbsp;&nbsp;<span>￥999</span></p>
                <a href="javascript:;">商家评分</a>
            </div>
            <div class="goods-go">
                <p>送至全国<span>卖家承担运费</span></p>
            </div>
            <div class="buy-goods">
                <p>购买数量</p>
                <button>+</button> <input type="text" value="1" > <button>-</button>
                <p>(库存数量 999+)</p>
            </div>
            <div class="add-car">
                <button>添加购物车</button>
            </div>
        </div>-->
    </div>

    <div class="serve">
        <div class="serve-center">
            <div class="serve-left">
                <h2>客服在线</h2>
                <div class="serve-tel">
                    <h2>021-56457299</h2>
                    <p>周一到周五9:00-17:30</p>
                </div>
            </div>
            <ul>
                <li>
                    <dl>
                        <dt>帮助中心</dt>
                        <dd><a href="javascript:;"> 忘记密码 </a></dd>
                        <dd><a href="javascript:;"> 积分兑换说明 </a></dd>
                        <dd><a href="javascript:;"> 积分细则 </a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>店主之家 </dt>
                        <dd><a href="javascript:;"> 如何申请开店 </a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>支付方式</dt>
                        <dd><a href="javascript:;"> 在线支付 </a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>售后服务 </dt>
                        <dd><a href="javascript:;"> 退换货政策 </a></dd>
                        <dd><a href="javascript:;"> 退款申请 </a></dd>
                        <dd><a href="javascript:;"> 退换货流程 </a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>客服中心</dt>
                        <dd><a href="javascript:;"> 会员修改密码 </a></dd>
                        <dd><a href="javascript:;"> 会员修改个人信息 </a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt></dt>
                        <dd></dd>
                    </dl>
                </li>
            </ul>
            <div class="serve-right">
                <ul>
                    <li>
                        <h2>为为网APP</h2>
                        <i class="weixin-app"></i>
                        <p>下载移动客户端</p>
                    </li>
                    <li>
                        <h2>为为网微信</h2>
                        <i class="weixin-weixin"></i>
                        <p>为为网官方微信</p>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div id="footer">
        <p>
            <a href="">首页</a> |
            <a href="">招聘英才</a> |
            <a href="">合作及洽谈</a> |
            <a href="">联系我们</a> |
            <a href="">关于我们</a> |
            <a href="">友情链接</a>
        </p>
        <span>Copyright 2015 沪ICP备08001311号 | 营业执照</span>
    </div>
</body>

</html>
<script src="js/jquery-1.11.1.min.js"></script>
<script src="js/cookie.js"></script>
<script type="text/javascript">
    window.onload = function () {
        // 显示商品详情
        function goodsInfo() {
            var str = location.href;
            str = str.split("?")[1];
            var arr = str.split("&");
            var cname = arr[0].split("=")[1];
            var pid = arr[1].split("=")[1];

            //请求服务器数据 根据cname和pid的值确定要显示的某个商品
            $.ajax({
                type: "get",
                url: "hotgoods.json",
                async: true,
                success: function (json) {
                    var arr = json[cname].list;
                    var str = "";
                    for (var i = 0; i < arr.length; i++) {
                        if (pid == arr[i].id) {
                            str = `<div id="small" class="goods-left">
                <img src="images/${arr[i].src}" alt=""/>
                <div id="mask"></div>
                <div id="big"> <img class="bigImage" src = "images/${arr[i].src}"></div>
            </div>
            <div class="goods-right">
                <h2>${arr[i].name}</h2>
                <div class="goods-price">
                    <p>活&nbsp;动&nbsp;价&nbsp;格&nbsp;&nbsp;<span>￥${arr[i].price}</span></p>
                    <a href="javascript:;">商家评分</a>
                </div>
                <div class="goods-go">
                    <p>送至全国<span>卖家承担运费</span></p>
                </div>
                <div class="buy-goods">
                    <p>购买数量</p>
                    <button id="btnl">+</button> <input id="qty" type="text" value="1" > <button id="btnr">-</button>
                    <p>(库存数量 999+)</p>
                </div>
                <div class="add-car">
                    <button id="btn" data-id="${arr[i].id}" data-src="${arr[i].src}" data-name="${arr[i].name}" data-price="${arr[i].price}">添加购物车</button>
                </div>
            </div>`;
                            break;
                        }
                    }
                    $(".goods-fdj").html(str);
                }
            })
        }
        goodsInfo();

        //  放大镜功能
        function goodsBig() {
            // 为动态添加的元素添加事件用on
            
            $(".goods-fdj").on("mouseenter", "#small", function () {
                $("#mask").show();
                $("#big").show();
            }).on("mouseleave", "#small", function () {
                $("#mask").hide();
                $("#big").hide();
            }).on("mousemove", "#small", function (evt) {
                let e = evt || event;
                let x = e.pageX - $("#mask").width() / 2 - $(".goods-left").offset().left;
                let y = e.pageY - $("#mask").height() / 2 - $(".goods-left").offset().top;
                let maxL = maxT = $("#small").width() - $("#mask").width();
                x = Math.min(Math.max(0, x), maxL);
                y = Math.min(Math.max(0, y), maxT);
                $("#mask").css({
                    "left": x,
                    "top": y
                });
                $("#big img").css({
                    left: -x * ($("#big img").width() / $("#small img").width()),
                    top: -y * ($("#big img").height() / $("#small img").height())
                })
            })
        }
        goodsBig();

        //添加购物车

        function shopCar() {
            var arr = []; // 用来存放多个商品
            $(".goods-fdj").on("click", "#btn", function () {
                // $count = parseInt($("#qty").val());
                var json = {}; // 用来存放一个商品信息
                json = {
                    id: $(this).data("id"),
                    src: $(this).data("src"),
                    name: $(this).data("name"),
                    price: $(this).data("price"),
                    count: 1
                }
                var flag = true;
                var storageTxt = localStorage.getItem("goodslist");

                if (storageTxt != null) {
                    var cookieInfo = JSON.parse(storageTxt);
                    for (var i = 0; i < cookieInfo.length; i++) {
                        if (json.id == cookieInfo[i].id) {
                            cookieInfo[i].count++;
                            arr = cookieInfo;
                            flag = false;
                            break;
                        }
                    }
                }
                if (flag) {
                    arr.push(json);
                }
                localStorage.setItem("goodslist", JSON.stringify(arr));
                location.href = "shopCar.html";
            })
        }

        shopCar();

    }
</script>